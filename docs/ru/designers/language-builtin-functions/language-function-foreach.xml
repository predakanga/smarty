<?xml version="1.0" encoding="UTF-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 1.8 Maintainer: freespace Status: ready -->
<sect1 id="language.function.foreach">
 <title>{foreach},{foreachelse}</title>
 <para>
  Циклы <emphasis>{foreach}</emphasis> являются альтернативой
  циклам <link
  linkend="language.function.section"><emphasis>{section}</emphasis></link>.
  <emphasis>{foreach}</emphasis> используется для прохода по
  <emphasis role="bold">единственному ассоциативному массиву</emphasis>.
  Синтаксис
  <emphasis>{foreach}</emphasis> намного проще синтаксиса
  <emphasis>{section}</emphasis>, но с другой стороны
  <emphasis role="bold">его можно использовать только для одного массива</emphasis>.
  Каждый тэг <emphasis>{foreach}</emphasis> должен иметь пару
  <emphasis>{/foreach}</emphasis>. Обязательными параметрами являются
  <emphasis>from</emphasis> и <emphasis>item</emphasis>.
  Имя цикла {foreach} может быть любым, состоящим из букв, цифр и знаков
  подчеркивания. Циклы <emphasis>{foreach}</emphasis> могут быть вложенными
  и имена вложенных {foreach} должны быть уникакльными между собой.
  Параметр <emphasis>from</emphasis> (обычно - массив значений)
  определяет количество итераций цикла <emphasis>{foreach}</emphasis>.
  <emphasis>{foreachelse}</emphasis> выполняется в том случае, если
  параметр <emphasis>from</emphasis> не содержит значений.
 </para>

 <informaltable frame="all">
  <tgroup cols="5">
  <colspec colname="param" align="center" />
  <colspec colname="type" align="center" />
  <colspec colname="required" align="center" />
  <colspec colname="default" align="center" />
  <colspec colname="desc" />
  <thead>
   <row>
    <entry>Имя атрибута</entry>
    <entry>Тип</entry>
    <entry>Обязателен</entry>
    <entry>По умолчанию</entry>
    <entry>Описание</entry>
   </row>
  </thead>
  <tbody>
   <row>
    <entry>from</entry>
    <entry>array</entry>
    <entry>Да</entry>
    <entry><emphasis>n/a</emphasis></entry>
    <entry>Массив, по которому надо пройтись</entry>
   </row>
   <row>
    <entry>item</entry>
    <entry>string</entry>
    <entry>Да</entry>
    <entry><emphasis>n/a</emphasis></entry>
    <entry>Имя переменной, которая будет выступать в
    качестве значения текущего елемента</entry>
   </row>
   <row>
    <entry>key</entry>
    <entry>string</entry>
    <entry>Нет</entry>
    <entry><emphasis>n/a</emphasis></entry>
    <entry>Имя переменной, которая будет выступать в
    качестве ключа текущего елемента</entry>
   </row>
   <row>
    <entry>name</entry>
    <entry>string</entry>
    <entry>Нет</entry>
    <entry><emphasis>n/a</emphasis></entry>
    <entry>Название цикла foreach для доступа к его
    свойствам</entry>
   </row>
  </tbody>
  </tgroup>
 </informaltable>

 <example>
  <title>{foreach} - предмет</title>
  <programlisting role="php">
<![CDATA[
<?php
$arr = array( 1001,1002,1003);
$smarty->assign('custid', $arr);
?>
]]>
  </programlisting>
  <programlisting>
<![CDATA[
{* этот пример напечатает все переменные массива $custid *}
{foreach from=$custid item=curr_id}
    id: {$curr_id}<br />
{/foreach}
]]>
  </programlisting>
  <para>
   Результат выполнения данного примера:
  </para>
  <screen>
<![CDATA[
id: 1000<br />
id: 1001<br />
id: 1002<br />
]]>
  </screen>
 </example>
  
 <example>
  <title>{foreach} - предмет и ключ</title>
  <programlisting role="php">
<![CDATA[
// Ключ содержит ключ для каждого значения из цикла
// назначение выглядит примерно так:
<?php
$smarty->assign('contacts', array(
                            array('phone' => '1',
                                  'fax' => '2',
                                   'cell' => '3'),
                            array('phone' => '555-4444',
                                  'fax' => '555-3333',
                                  'cell' => '760-1234')
                            ));
?>
]]>
  </programlisting>
  <programlisting>
<![CDATA[
{foreach name=outer item=contact from=$contacts}
    <hr />
    {foreach key=key item=item from=$contact}
        {$key}: {$item}&lt;br&gt;
        {$key}: {$item}<br />
    {/foreach}
{/foreach}
]]>
  </programlisting>
  <para>
   Результат выполнения данного примера:
  </para>
  <screen>
<![CDATA[
<hr />
    phone: 1<br />
    fax: 2<br />
    cell: 3<br />
<hr />
    phone: 555-4444<br />
    fax: 555-3333<br />
    cell: 760-1234<br />
]]>
  </screen>
 </example>
  
 <example>
  <title>{foreach} - базы данных (к примеру, PEAR или ADODB)</title>
  <programlisting role="php">
<![CDATA[
<?php
  $sql = 'select contact_id, name, nick from contacts order by contact';
  $smarty->assign("contacts", $db->getAssoc($sql));
?>
]]>
  </programlisting>
  <programlisting>
<![CDATA[
{foreach key=cid item=con from=$contacts}
    <a href="contact.php?contact_id={$cid}">{$con.name} - {$con.nick}</a><br />
{/foreach}
]]>
  </programlisting>
 </example>  

	<para>
		Циклы {foreach} также имеют собственные переменные, которые содержат свойства
		{foreach}.
		Они обозначаются так:
		<link linkend="language.variables.smarty.loops">{$smarty.foreach.foreachname.varname}</link>
		{$smarty.foreach.foreachname.varname}, где foreachname - это название цикла
		(значение атрибута <emphasis>name</emphasis>).
	</para>
	
 <para>
  См. <link linkend="section.property.index">{section}</link>
  для примеров следующих свойств, так как они идентичны.
 </para>

	<sect2 id="foreach.property.iteration">
		<title>iteration</title>
		<para>
   iteration используется для отображения текущего номера итерации цикла.
   Итерации всегда начинаются с 1 и увеличиваются на одну при каждом
   прохождении цикла.
		</para>
	</sect2>

	<sect2 id="foreach.property.first">
		<title>first</title>
			<para>
   	<emphasis>first</emphasis> устанавливается в true, если текущая итерация первая.
			</para>
	</sect2>

	<sect2 id="foreach.property.last">
		<title>last</title>
		<para>
  	<emphasis>last</emphasis> устанавливается в true, если текущая итерация последняя.
		</para>
	</sect2>

	<sect2 id="foreach.property.show">
		<title>show</title>
		<para>
   Атрибут <emphasis>show</emphasis> может принимать логические
   значения (истина или ложь). Если ложь, то цикл foreach не будет
   отображаться. Если присутствует тэг foreachelse, то он будет
   отображен.
 	</para>
 </sect2>

	<sect2 id="foreach.property.total">
 	<title>total</title>
		<para>
	 	<emphasis>total</emphasis> хранит количество итераций цикла.
			Может быть использовано как в цикле, так и вне его.
		</para>

  <para>
   См. также <link linkend="language.function.section">{section}</link> и
   <link linkend="language.variables.smarty.loops">$smarty.foreach</link>.
  </para>
 </sect2>
</sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->

